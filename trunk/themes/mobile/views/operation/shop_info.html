<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=640, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.bootcss.com/normalize/8.0.0/normalize.min.css">
    <title>{$seo_title}</title>
</head>
<style type="text/css">
#app{

}
.header{
    /*margin-top: 2%;*/
    padding-left: 3%;
    /*padding-bottom: 10px;*/
    border-bottom: 0.1px  solid #ccc;
}
.header p{
    margin-top:20px;
    font-size: 18px;
    font-weight: bold;
}
.Wdate{
    width: 30%;
    height: 30px !important;
    background: #fff url(/themes/mobile/images/op_center/--04.jpg) no-repeat right !important;
}
.line{
    margin-top: 10px;
    width: 94%;
    height: 40px;
    margin-left: 4%;
    padding-left: 2%;
    border-left: 3px solid #4eabf4;
    font-size: 20px;
    font-weight: bold;
    line-height: 40px;
    color: #333; 
}
.line span{
    color:#ccc;
}
.line-info{
    margin-top: -10px;
    border-top: 0.1px solid #ccc;
    /*border-bottom: 0.1px solid #ccc;*/
    padding-left: 5%;
    padding-top: 10px;
    padding-bottom: 20px;
    height: 100px;
}
.line-info span{
    display: inline-block;
    width: 40%;
    height: 33px;
    float: left;
    font-size: 18px;
    color: #666;
    margin-bottom: 4px;
}
.line-info img{
    width: 33px;
    height: 33px;
    vertical-align: -33%;
}
.line-info p{
    display: inline;
}
.line-infos{
    margin-top: -10px;
    border-top: 0.1px solid #ccc;
    /*border-bottom: 0.1px solid #ccc;*/
    padding-left: 5%;
    padding-top: 10px;
    /*padding-bottom: 10px;*/
    height: 180px;
}
.line-infos span{
    display: inline-block;
    width: 80%;
    height: 33px;
    float: left;
    font-size: 18px;
    color: #666;
}
.line-infos p{
    display: inline;
}
.line-infos img{
    width: 30px;
    height: 30px;
    vertical-align: -33%;
}
.list{
    border-top: 0.1px solid #ccc;
    padding-top: 10px;
}
.list-child{
    border-bottom: 0.1px solid #ccc;
    width: 100%;
    padding-left: 5%;
    padding-right: 5%;
    padding-bottom: 10px;
    padding-top: 14px;
}
.div-child{
    width: 100%;
    height: 33px;
    margin-bottom: 4px;
}
.div-child a{
    text-decoration: none;
    color: #4eabf4;
    float: right;
    margin-right: 10%;
    font-size: 18px;
}
.div-child span{
    color:#666;
    font-size: 18px;
}
.span-right{
    float: right;
    margin-right: 10%;
}
.list-child img{
    width: 33px;
    height: 33px;
    vertical-align: -33%;
}
iframe{
    width: 400px !important;
    height: 230px !important;
}
.WdateDiv{
    width: 400px !important;
    height: 230px !important;
}
</style>
<body>
<div id="app">
  <input type="hidden" name="page" id="page" value="{$page}"/>
  <div class="header">
    <p>
     统计时间：
     <input name="start_date" type="text" class="Wdate"   pattern="required"  onChange="" value="{$start_date|date('Y-m-d H:i:s',strtotime($start_date))|''}" onfocus="WdatePicker()">
    &nbsp;&nbsp;至&nbsp;&nbsp;
    <input name="end_date" class="Wdate" type="text" pattern="required" onChange="" value="{$end_date|date('Y-m-d H:i:s',strtotime($end_date))|''}"  onfocus="WdatePicker()">
    </p>
  </div>
  <div class="block">
    <div class="line">个人信息</div><br/>
    <div class="line-infos" style="height: 100px;">
      <span>名称：{$result['real_name'] | $result['nickname']}</span>
      <span>手机号码：{$result['mobile'] | '--'}</span>
      <span>加入时间{$result['create_time']}</span>
    </div>
  </div>
  <div class="block">
    <div class="line">数量总统计</div><br/>
    <div class="line-info">
      <span><img src="/themes/mobile/images/op_center/--05.jpg" >&nbsp;&nbsp;&nbsp;线上总订单：<p id="order_num">{$result['order_num']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--06.jpg" >&nbsp;&nbsp;&nbsp;扫码总订单：<p id="offline_order_num">{$result['offline_order_num']}</p></span><br/>
      <span><img src="/themes/mobile/images/op_center/--09.jpg" >&nbsp;&nbsp;&nbsp;经销商数量：<p id="shop_num">{$result['shop_num']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--07.jpg" >&nbsp;&nbsp;&nbsp;商家数量：<p id="promoter_num">{$result['promoter_num']}</p></span><br/>
      <span><img src="/themes/mobile/images/op_center/--08.jpg" >&nbsp;&nbsp;&nbsp;会员数量：<p id="user_num">{$result['user_num']}</p></span>
    </div>
  </div>
  <div class="block">
    <div class="line">金额总统计</div><br/>
    <div class="line-infos">
      <span><img src="/themes/mobile/images/op_center/--10.jpg" >&nbsp;&nbsp;&nbsp;线上订单总金额：<p id="order_sum">{$result['order_sum']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--13.jpg" >&nbsp;&nbsp;&nbsp;扫码订单总金额：<p id="offline_order_sum">{$result['offline_order_sum']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--11.jpg" >&nbsp;&nbsp;&nbsp;线上订单跨界收益：<p id="order_benefit">{$result['order_benefit']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--12.jpg" >&nbsp;&nbsp;&nbsp;扫码订单跨界收益：<p id="crossover_sum">{$result['crossover_sum']}</p></span>
      <span><img src="/themes/mobile/images/op_center/--14.jpg" >&nbsp;&nbsp;&nbsp;优惠购收益：<p id="benefit_sum">{$result['benefit_sum']}</p></span>
    </div>
  </div>
  
</div>
</body>
<script src="/runtime/systemjs/jquery.min.js"></script>
<script src="/static/js/datepicker.js"></script>
<!-- <script src="/runtime/systemjs/My97DatePicker/calendar.js"></script> -->
<script src="/runtime/systemjs/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="/themes/mobile/js/layer_mobile/layer.js"></script>
<script type="text/javascript">
$("input[name='end_date']").change(function(){
    var start_date = $("input[name='start_date']").val();
    var end_date = $("input[name='end_date']").val();
    var user_id = "{$user_id}";
    var url = "/operation/operation_center?user_id="+user_id+"&start_date="+start_date+"&end_date="+end_date;
    window.location.href = url;
});
function getScrollTop() { 
        var scrollTop = 0; 
        if (document.documentElement && document.documentElement.scrollTop) { 
            scrollTop = document.documentElement.scrollTop; 
        } else if (document.body) { 
            scrollTop = document.body.scrollTop; 
        } 
        return scrollTop; 
    } 
    // 获取当前可视范围的高度 
    function getClientHeight() { 
        var clientHeight = 0; 
        if (document.body.clientHeight && document.documentElement.clientHeight) { 
            clientHeight = Math.min(document.body.clientHeight, document.documentElement.clientHeight); 
        } 
        else { 
            clientHeight = Math.max(document.body.clientHeight, document.documentElement.clientHeight); 
        } 
        return clientHeight; 
    }
    // 获取文档完整的高度 
    function getScrollHeight() { 
        return Math.max(document.body.scrollHeight, document.documentElement.scrollHeight); 
    }

    var page = $('#page').val();
    $(window).bind('scroll', function () {
        if (getScrollTop() + getClientHeight() == getScrollHeight()) {
            page++;
            ajaxRead();
        }
    });

    function ajaxRead() {
        var html = "";
        var url = "{url:/operation/ajax_operation_center}";
        var user_id = "{$user_id}";
        var start_date = $("input[name='start_date']").val();
        var end_date = $("input[name='end_date']").val();
        var data = {page: page,user_id:user_id,start_date:start_date,end_date:end_date};
        var index;
        $.ajax({
            type: 'post',
            dataType: 'json',
            url: url,
            data: data,
            success: function (res) {
                var jsonstr = JSON.stringify(res);
                var jsonarray= $.parseJSON(jsonstr);
                if (jsonarray.length == 0) {
                    layer.msg('已经到底!',{time:500});
                }  else {
                    $.each(jsonarray, function (i, item) {
                        html += '<div class="list-child">';
                        html += '<div class="div-child">';
                        if(item.real_name!=null) {
                           html += '<span>名称：'+item.real_name+'</span>';
                        } else {
                           html += '<span>名称：'+item.nickname+'</span>';
                        }
                        if(item.role_type==2) {
                           html += '<span class="span-right"><i><img src="/themes/mobile/images/op_center/--09.jpg"></i>经销商</span>';
                        } else {
                           html += '<span class="span-right"><i><img src="/themes/mobile/images/op_center/--07.jpg"></i>商家</span>';
                        }
                        html += '</div>';
                        html += '<div class="div-child">';
                        if(item.mobile!=null) {
                            html += '<span>手机号：'+item.mobile+'</span><br/>';
                        } else {
                            html += '<span>手机号：--</span><br/>';
                        }   
                        html += '</div>';
                        html += '<div class="div-child">';
                        if(item.realname!=null) {
                           html += '<span>经营者：'+item.realname+'</span>';
                        } else if(item.mobile!=null) {
                           html += '<span>经营者：'+item.mobile+'</span>';
                        } else {
                           html += '<span>经营者：'+item.real_name+'</span>';
                        }
                        html += '</div>';
                        html += '<div class="div-child">';
                        html += '<span>加入时间：'+item.create_time+'</span>'
                        html += '<a href="/operation/shop_info/user_id/'+item.id+'">查看详情</a>';
                        html += '</div>';
                        html += '</div>';
                    });
                    $("#list").append(html);
                }
            },
        });
    }
</script>
</html>